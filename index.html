<!DOCTYPE "html">
<html>
    <head>
        <meta charset="utf-8" />
        <title>Symatem</title>
        <meta name="author" content="Alexander Meißner" />
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <meta name="theme-color" content="#FFFFFF" />
        <link rel="icon" type="image/png" href="logo.png" />
        <link rel="stylesheet" type="text/css" href="./node_modules/SvgPanels/style.css" />
        <link rel="stylesheet" type="text/css" href="style.css" />
        <script type="module">
            import { vec2 } from './node_modules/SvgPanels/Panel.js';
            import { LabelPanel, RectPanel, SpeechBalloonPanel, TextFieldPanel, ImagePanel } from './node_modules/SvgPanels/Atoms.js';
            import { ContainerPanel, RootPanel, AdaptiveSizeContainerPanel, CheckboxPanel, PanePanel, TilingPanel, ToolbarPanel, ConfigurableSplitViewPanel, TabsViewPanel, ScrollViewPanel, SliderPanel, CollapsibleViewPanel } from './node_modules/SvgPanels/Containers.js';
            import { AnimatedLogoPanel } from './Logo.js';
            import { backend, TriplePanel, SymbolDataContentPanel, NamespacePanel } from './Basics.js';
            import { RepositoryPanel } from './VersionControl.js';

            const root = new RootPanel(document.body, vec2.create());
            document.body.onresize = root.recalculateLayout.bind(root);
            document.body.onload = () => {
                root.recalculateLayout();
                const circleRadius = Math.min(root.size[0], root.size[1])*0.8,
                      animatedLogoPanel = new AnimatedLogoPanel(vec2.create(), vec2.fromValues(circleRadius, circleRadius));
                root.content.insertChild(animatedLogoPanel);
                animatedLogoPanel.startAnimation();
                animatedLogoPanel.onend = () => {
                    root.content.removeChild(animatedLogoPanel);
                    root.content.insertChildAnimated(headerSplit);
                    headerSplit.recalculateLayout();
                };
            };

            const aboutPanel = new AdaptiveSizeContainerPanel(vec2.create());
            aboutPanel.padding = vec2.fromValues(10, 10);
            aboutPanel.backgroundPanel = new SpeechBalloonPanel(vec2.create(), vec2.create());
            aboutPanel.backgroundPanel.updateSize();
            const logoPanel = new ImagePanel(vec2.create(), vec2.fromValues(300, 300), 'logo.svg');
            aboutPanel.insertChild(logoPanel);
            const titleLabel = new LabelPanel(vec2.fromValues(0, 180), 'Symatem UI');
            aboutPanel.insertChild(titleLabel);
            const versionLabel = new LabelPanel(vec2.fromValues(0, 200), '0.0.1');
            aboutPanel.insertChild(versionLabel);
            aboutPanel.recalculateLayout();

            const headerSplit = new TilingPanel(vec2.create(), root.size);
            headerSplit.axis = 1;
            headerSplit.sizeAlongAxis = -1;
            headerSplit.otherAxisSizeStays = true;
            headerSplit.otherAxisAlignment = 'stretch';
            headerSplit.registerFocusNavigationEvent();
            root.toolBar = new ToolbarPanel(vec2.create());
            headerSplit.insertChild(root.toolBar);
            root.toolBar.addEntries([
                {'content': new ImagePanel(vec2.create(), vec2.fromValues(15, 15), 'logo.svg'), 'children': [
                    {'content': 'About', 'action': (event) => {
                        root.openModalOverlay(event, aboutPanel);
                    }}
                ]},
                {'content': 'Layout', 'children': [
                    {'content': 'Toggle Fullscreen', 'shortCut': '^⌘F', 'action': root.toggleFullscreen.bind(root)},
                    {'content': 'Split Horizontally', 'shortCut': '⌘H'},
                    {'content': 'Split Vertically', 'shortCut': '⌘V'},
                    {'content': 'Make Tabs', 'shortCut': '⌘T'},
                    {'content': 'Test', 'children': [
                        {'content': 'Pointless'},
                        {'content': 'Test', 'children': [
                            {'content': 'Pointless'}
                        ]}
                    ]}
                ]},
                {'content': 'Edit', 'children': [
                    {'content': 'Undo', 'shortCut': '⌘Z'},
                    {'content': 'Redo', 'shortCut': '⇧⌘Z'},
                    {'content': 'Delete', 'shortCut': '⌫'},
                    {'content': 'Cut', 'shortCut': '⌘X'},
                    {'content': 'Copy', 'shortCut': '⌘C'},
                    {'content': 'Paste', 'shortCut': '⌘V'}
                ]},
                {'content': 'Select', 'children': [
                    {'content': 'All', 'shortCut': '⌘A'},
                    {'content': 'None', 'shortCut': '⇧⌘A'}
                ]},
                {'content': 'Navigate', 'children': [
                    {'content': 'In', 'shortCut': '↹', 'action': root.navigateFocus.bind(root, 'in')},
                    {'content': 'Out', 'shortCut': '⇧↹', 'action': root.navigateFocus.bind(root, 'out')},
                    {'content': 'Left', 'shortCut': '←', 'action': root.navigateFocus.bind(root, 'left')},
                    {'content': 'Right', 'shortCut': '→', 'action': root.navigateFocus.bind(root, 'right')},
                    {'content': 'Up', 'shortCut': '↑', 'action': root.navigateFocus.bind(root, 'up')},
                    {'content': 'Down', 'shortCut': '↓', 'action': root.navigateFocus.bind(root, 'down')},
                    {'content': 'Defocus', 'action': root.navigateFocus.bind(root, 'defocus')}
                ]}
            ]);

            const splitViewA = new ConfigurableSplitViewPanel(vec2.create(), vec2.create());
            {
                splitViewA.padding = vec2.fromValues(2, 2);
                headerSplit.insertChild(splitViewA);
                splitViewA.axis = 0;
                const paneA = new RepositoryPanel(vec2.create(), backend.symbolByName.VersionControl);
                {
                    splitViewA.insertChild(paneA);
                    paneA.relativeSize = 0.25;
                }
                const paneB = new NamespacePanel(vec2.create());
                {
                    splitViewA.insertChild(paneB);
                    paneB.relativeSize = 0.25;
                }
                const splitViewB = new ConfigurableSplitViewPanel(vec2.fromValues(0, 0), vec2.fromValues(0, 0));
                {
                    splitViewA.insertChild(splitViewB);
                    splitViewB.relativeSize = 0.5;
                    splitViewB.axis = 1;
                    const paneC = new TriplePanel(vec2.create());
                    {
                        splitViewB.insertChild(paneC);
                        paneC.relativeSize = 0.5;
                    }
                    const tabsView = new TabsViewPanel(vec2.create(), vec2.create());
                    {
                        splitViewB.insertChild(tabsView);
                        tabsView.relativeSize = 0.5;
                        tabsView.enableTabDragging = true;
                        for(let i = 0; i < 4; ++i) {
                            const tabHandle = tabsView.addTab(),
                                  tabLabel = new LabelPanel(vec2.create());
                            tabHandle.insertChild(tabLabel);
                            tabLabel.text = 'Tab '+i;
                            tabHandle.recalculateLayout();
                        }
                        tabsView.tabsContainer.recalculateLayout();
                        tabsView.tabsContainer.children[0].content = new SymbolDataContentPanel(vec2.create());
                        const paneA = new PanePanel(vec2.create(), vec2.create());
                        const slider = new SliderPanel(vec2.fromValues(0, 0), vec2.fromValues(50, 20));
                        slider.updatePosition();
                        paneA.insertChild(slider);
                        tabsView.tabsContainer.children[1].content = paneA;
                        const paneB = new PanePanel(vec2.create(), vec2.create());
                        const checkbox = new CheckboxPanel(vec2.fromValues(0, 0));
                        checkbox.updatePosition();
                        paneB.insertChild(checkbox);
                        tabsView.tabsContainer.children[2].content = paneB;
                        const paneC = new PanePanel(vec2.create(), vec2.create());
                        const collapsibleView = new CollapsibleViewPanel(vec2.fromValues(0, 0), vec2.fromValues(200, 200));
                        paneC.insertChild(collapsibleView);
                        tabsView.tabsContainer.children[3].content = paneC;
                        collapsibleView.updatePosition();
                        collapsibleView.headerPanel.text = 'Collapsible View';
                        collapsibleView.horizontalSplit.recalculateLayout();
                        const rectPanel = new RectPanel(vec2.create(), vec2.fromValues(200, 200));
                        rectPanel.updateSize();
                        rectPanel.node.style.fill = 'grey';
                        collapsibleView.contentPanel.insertChild(rectPanel);
                        collapsibleView.contentPanel.recalculateLayout();
                    }
                }
            }
        </script>
    </head>
    <body>
    </body>
</html>
